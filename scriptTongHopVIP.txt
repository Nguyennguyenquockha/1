-- Xóa intro cũ nếu có
if game:GetService("CoreGui"):FindFirstChild("IntroGui") then
    game:GetService("CoreGui").IntroGui:Destroy()
end

local CoreGui = game:GetService("CoreGui")
local TweenService = game:GetService("TweenService")
local RunService = game:GetService("RunService")
local HttpService = game:GetService("HttpService")

-- ScreenGui
local introGui = Instance.new("ScreenGui")
introGui.Name = "IntroGui"
introGui.Parent = CoreGui
introGui.IgnoreGuiInset = true
introGui.ResetOnSpawn = false

-- Nền mờ
local background = Instance.new("Frame")
background.Size = UDim2.new(1, 0, 1, 0)
background.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
background.BackgroundTransparency = 0.4
background.BorderSizePixel = 0
background.Parent = introGui

-- Tiêu đề
local textLabel = Instance.new("TextLabel")
textLabel.Size = UDim2.new(1, 0, 0, 120)
textLabel.Position = UDim2.new(0, 0, 0.38, 0)
textLabel.BackgroundTransparency = 1
textLabel.Font = Enum.Font.GothamBold
textLabel.TextSize = 90
textLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
textLabel.TextStrokeTransparency = 0
textLabel.TextStrokeColor3 = Color3.fromRGB(255, 255, 255)
textLabel.Text = ""
textLabel.Parent = introGui

-- Gradient
local gradient = Instance.new("UIGradient")
gradient.Color = ColorSequence.new{
    ColorSequenceKeypoint.new(0, Color3.fromRGB(0, 102, 204)),
    ColorSequenceKeypoint.new(1, Color3.fromRGB(135, 206, 250))
}
gradient.Parent = textLabel

-- Glow chữ
local glow = Instance.new("UIStroke")
glow.Thickness = 2
glow.Color = Color3.fromRGB(255, 255, 255)
glow.Transparency = 0.6
glow.Parent = textLabel

-- Loading label
local loadingLabel = Instance.new("TextLabel")
loadingLabel.Size = UDim2.new(0, 200, 0, 20)
loadingLabel.Position = UDim2.new(0.5, -100, 1, -120)
loadingLabel.BackgroundTransparency = 1
loadingLabel.Font = Enum.Font.GothamSemibold
loadingLabel.TextSize = 20
loadingLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
loadingLabel.Text = "Loading... 0.0%"
loadingLabel.Parent = introGui

-- Nền loading
local loadingBackground = Instance.new("Frame")
loadingBackground.Size = UDim2.new(0, 320, 0, 20)
loadingBackground.Position = UDim2.new(0.5, -160, 1, -80)
loadingBackground.BackgroundColor3 = Color3.fromRGB(100, 100, 100)
loadingBackground.BorderSizePixel = 0
loadingBackground.Parent = introGui

local bgCorner = Instance.new("UICorner")
bgCorner.CornerRadius = UDim.new(1, 0)
bgCorner.Parent = loadingBackground

-- Thanh loading
local loadingBar = Instance.new("Frame")
loadingBar.Size = UDim2.new(0, 0, 1, 0)
loadingBar.BackgroundColor3 = Color3.fromRGB(0, 255, 255)
loadingBar.BorderSizePixel = 0
loadingBar.Parent = loadingBackground

local barCorner = Instance.new("UICorner")
barCorner.CornerRadius = UDim.new(1, 0)
barCorner.Parent = loadingBar

-- Typing effect
local fullText = "KHA HUB SCRIPT"
for i = 1, #fullText do
    textLabel.Text = string.sub(fullText, 1, i)
    task.wait(0.1)
end

-- Thời gian loading lâu hơn
local totalTime = 6
local startTime = tick()

-- Tween loading bar
local tween = TweenService:Create(loadingBar, TweenInfo.new(totalTime, Enum.EasingStyle.Linear), {
    Size = UDim2.new(1, 0, 1, 0)
})
tween:Play()

-- Cập nhật % mượt (thập phân 1 chữ số)
RunService.RenderStepped:Connect(function()
    local elapsed = tick() - startTime
    local percent = math.clamp((elapsed / totalTime) * 100, 0, 100)
    loadingLabel.Text = string.format("Loading... %.1f%%", percent)
end)

-- Hiệu ứng nhấp nhô cực nhẹ
task.spawn(function()
    while tick() - startTime < totalTime do
        TweenService:Create(loadingBackground, TweenInfo.new(0.4, Enum.EasingStyle.Sine, Enum.EasingDirection.Out), {
            Position = UDim2.new(0.5, -160, 1, -79)
        }):Play()
        task.wait(0.4)
        TweenService:Create(loadingBackground, TweenInfo.new(0.4, Enum.EasingStyle.Sine, Enum.EasingDirection.Out), {
            Position = UDim2.new(0.5, -160, 1, -81)
        }):Play()
        task.wait(0.4)
    end
end)

-- Kết thúc
task.wait(totalTime)
TweenService:Create(background, TweenInfo.new(0.3), {BackgroundTransparency = 1}):Play()
TweenService:Create(textLabel, TweenInfo.new(0.3), {TextTransparency = 1, TextStrokeTransparency = 1}):Play()
TweenService:Create(glow, TweenInfo.new(0.3), {Transparency = 1}):Play()
TweenService:Create(loadingLabel, TweenInfo.new(0.3), {TextTransparency = 1}):Play()
TweenService:Create(loadingBackground, TweenInfo.new(0.3), {BackgroundTransparency = 1}):Play()
TweenService:Create(loadingBar, TweenInfo.new(0.3), {BackgroundTransparency = 1}):Play()

task.wait(0.35)
introGui:Destroy()

-- Chạy script chính
loadstring(game:HttpGet("https://raw.githubusercontent.com/Nguyennguyenquockha/1/refs/heads/main/tonghopNewUi.txt"))()