local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local TweenService = game:GetService("TweenService")
local UserInputService = game:GetService("UserInputService")
local Stats = game:GetService("Stats")
local player = Players.LocalPlayer

local boostGui
local enforceConnection
local boostBtn
local boostAktif = false
local boostTime = 0
local DEFAULT_WALKSPEED = 16

-- Kéo GUI được cả Mobile + PC
local function enableDragging(frame)
	local dragging, dragInput, dragStart, startPos

	local function update(input)
		local delta = input.Position - dragStart
		local newPosition = UDim2.new(
			startPos.X.Scale,
			startPos.X.Offset + delta.X,
			startPos.Y.Scale,
			startPos.Y.Offset + delta.Y
		)
		frame.Position = newPosition
	end

	frame.InputBegan:Connect(function(input)
		if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
			dragging = true
			dragStart = input.Position
			startPos = frame.Position

			input.Changed:Connect(function()
				if input.UserInputState == Enum.UserInputState.End then
					dragging = false
				end
			end)
		end
	end)

	frame.InputChanged:Connect(function(input)
		if input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch then
			dragInput = input
		end
	end)

	UserInputService.InputChanged:Connect(function(input)
		if dragging and input == dragInput then
			update(input)
		end
	end)
end

local function startEnforceSpeed()
	local character = player.Character or player.CharacterAdded:Wait()
	local humanoid = character:WaitForChild("Humanoid")

	if enforceConnection then enforceConnection:Disconnect() end

	enforceConnection = RunService.Heartbeat:Connect(function()
		if humanoid.WalkSpeed ~= 42 then
			humanoid.WalkSpeed = 42
		end
	end)

	humanoid:GetPropertyChangedSignal("WalkSpeed"):Connect(function()
		if boostAktif and humanoid.WalkSpeed ~= 42 then
			humanoid.WalkSpeed = 42
		end
	end)

	humanoid.WalkSpeed = 42
end

local function stopEnforceSpeed()
	if enforceConnection then
		enforceConnection:Disconnect()
		enforceConnection = nil
	end

	local char = player.Character
	if char then
		local hum = char:FindFirstChildOfClass("Humanoid")
		if hum then
			hum.WalkSpeed = DEFAULT_WALKSPEED
		end
	end
end

local function buatBoostGUI()
	if boostGui then return end

	boostGui = Instance.new("ScreenGui", player:WaitForChild("PlayerGui"))
	boostGui.Name = "BoostGUI"
	boostGui.ResetOnSpawn = false

	boostBtn = Instance.new("TextButton", boostGui)
	boostBtn.Size = UDim2.new(0, 96, 0, 32)
	boostBtn.Position = UDim2.new(0.5, 0, 1, -70)
	boostBtn.AnchorPoint = Vector2.new(0.5, 1)
	boostBtn.BackgroundColor3 = Color3.fromRGB(0, 85, 170)
	boostBtn.TextColor3 = Color3.new(1, 1, 1)
	boostBtn.TextStrokeColor3 = Color3.new(0, 0, 0)
    boostBtn.TextStrokeTransparency = 0
	boostBtn.Font = Enum.Font.FredokaOne
	boostBtn.TextSize = 17
	boostBtn.BorderSizePixel = 0
	boostBtn.AutoButtonColor = false
	boostBtn.Text = "Boost OFF"

	local corner = Instance.new("UICorner")
	corner.CornerRadius = UDim.new(0, 10)
	corner.Parent = boostBtn

	local stroke = Instance.new("UIStroke")
	stroke.Color = Color3.fromRGB(0, 200, 255)
	stroke.Thickness = 2
	stroke.Transparency = 0.1
	stroke.ApplyStrokeMode = Enum.ApplyStrokeMode.Border
	stroke.Parent = boostBtn

	local clickSound = Instance.new("Sound")
	clickSound.SoundId = "rbxassetid://9080070218"
	clickSound.Volume = 1
	clickSound.Parent = boostBtn

	enableDragging(boostBtn)

	local statusFrame = Instance.new("Frame", boostGui)
	statusFrame.Size = UDim2.new(0, 260, 0, 95)
	statusFrame.Position = UDim2.new(1, -250, 0, 10)
	statusFrame.AnchorPoint = Vector2.new(0, 0)
	statusFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
	
	local bgImage = Instance.new("ImageLabel")
    bgImage.Size = UDim2.new(1, 0, 1, 0)
    bgImage.Position = UDim2.new(0, 0, 0, 0)
    bgImage.BackgroundTransparency = 1
    bgImage.Image = "rbxassetid://18878365966"
    bgImage.ZIndex = 0
    bgImage.Parent = statusFrame
	statusFrame.BackgroundTransparency = 0.2
	statusFrame.BorderSizePixel = 0

	local corner2 = Instance.new("UICorner")
	corner2.CornerRadius = UDim.new(0, 6)
	corner2.Parent = statusFrame

	local stroke2 = Instance.new("UIStroke")
	stroke2.Color = Color3.fromRGB(0, 200, 255)
	stroke2.Thickness = 1.5
	stroke2.Transparency = 0.1
	stroke2.ApplyStrokeMode = Enum.ApplyStrokeMode.Border
	stroke2.Parent = statusFrame

	local statusText = Instance.new("TextLabel", statusFrame)
	statusText.Size = UDim2.new(1, -10, 1, -10)
	statusText.Position = UDim2.new(0, 5, 0, 5)
	statusText.BackgroundTransparency = 1
	statusText.TextColor3 = Color3.new(1, 1, 1)
	statusText.TextStrokeColor3 = Color3.new(0, 0, 0)
    statusText.TextStrokeTransparency = 0
	statusText.Font = Enum.Font.FredokaOne
	statusText.TextSize = 14
	statusText.TextXAlignment = Enum.TextXAlignment.Left
	statusText.TextYAlignment = Enum.TextYAlignment.Top
	statusText.RichText = true
	statusText.ZIndex = 1
	statusText.Text = "Tốc độ chạy hiện tại: 16\nTrạng thái của boost: OFF\nThời gian boost: 0 giây\nPing: 0 ms\nFPS: 0"

	enableDragging(statusFrame)

	local fps = 0
	local lastTime = tick()
	local counter = 0

	RunService.RenderStepped:Connect(function()
		local hum = player.Character and player.Character:FindFirstChildOfClass("Humanoid")
		if hum then
			local ws = math.floor(hum.WalkSpeed + 0.5)
			local boostColor = boostAktif and "<font color='rgb(0,255,0)'>ON</font>" or "<font color='rgb(255,0,0)'>OFF</font>"
			local ping = math.floor(Stats.Network.ServerStatsItem["Data Ping"]:GetValue())
			statusText.Text = "Tốc độ chạy hiện tại: " .. ws ..
				"\nTrạng thái của boost: " .. boostColor ..
				"\nThời gian boost: " .. boostTime .. " giây" ..
				"\nPing: " .. ping .. " ms" ..
				"\nFPS: " .. fps
		end

		counter += 1
		if tick() - lastTime >= 1 then
			fps = counter
			counter = 0
			lastTime = tick()
			if boostAktif then
				boostTime += 1
			end
		end
	end)

	boostBtn.MouseButton1Click:Connect(function()
		clickSound:Play()
		boostAktif = not boostAktif

		local tweenUp = TweenService:Create(boostBtn, TweenInfo.new(0.1, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {
			Size = UDim2.new(0, 106, 0, 38)
		})
		local tweenDown = TweenService:Create(boostBtn, TweenInfo.new(0.1, Enum.EasingStyle.Quad, Enum.EasingDirection.In), {
			Size = UDim2.new(0, 96, 0, 32)
		})
		tweenUp:Play()
		tweenUp.Completed:Connect(function()
			tweenDown:Play()
		end)

		if boostAktif then
			boostBtn.Text = "Boost ON"
			startEnforceSpeed()
		else
			boostBtn.Text = "Boost OFF"
			stopEnforceSpeed()
			boostTime = 0
		end
	end)
end

buatBoostGUI()

Players.LocalPlayer.CharacterAdded:Connect(function()
	if boostAktif then
		startEnforceSpeed()
	else
		stopEnforceSpeed()
	end
end)